<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title></title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.js'></script>
<script src='power.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.38.0/mapbox-gl.css' rel='stylesheet' />
<style>
html, body {
	width: 100%;
	height: 100%;
	margin: 0;
	padding: 0;
}
body {
	display: flex;
	flex-direction: column;
}
#map {
	flex-grow: 1;
}
</style>
</head>
<body>
<div id='checks'>
	<label><input type="checkbox" id="check_lines" checked="yes"> Show powerlines</label>
	<label><input type="checkbox" id="check_grid"> Highlight ERCOT lines</label>
	<label><input type="checkbox" id="check_rtm"> Show ERCOT real-time market</label>
</div>
<div id='map' class='map'></div>
<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoia3JlM2QiLCJhIjoiY2lwcjJrZ3p2MDZyOWZvbTN0bXV1eXF6ZiJ9.xXv_HMXLK04bEtmuwsEyMQ';
var map = new mapboxgl.Map({
	container: 'map',
	style: 'basic.json',
	hash: true,
	center: [-98.34, 30.55],
	zoom: 6
});

map.on('style.load', function () {
	style_init();

	var grid_check = document.getElementById('check_grid');
	grid_check.addEventListener('change', function(e) {
		var checked = e.target.checked;
		set_show_powerlines(true, checked);
		set_ercot_boundary(checked);
	});

	document.getElementById('check_rtm').addEventListener('change', function(e) {
		var checked = e.target.checked;
		set_ercot_rtm(checked);
	});

	document.getElementById('check_lines').addEventListener('change', function(e) {
		var checked = e.target.checked;
		set_show_powerlines(checked, grid_check.checked);
		grid_check.disabled = !checked;
	});
});

</script>
</body>
</html>
